{"version":3,"sources":["goods_list.js"],"names":["$","QueryObj","query","cid","getUrl","pagenum","pagesize","TotalPage","init","eventList","mui","pullRefresh","container","down","auto","callback","cb","data","html","template","arr","console","log","endPulldownToRefresh","refresh","goodsSearch","up","endPullupToRefresh","append","on","href","location","func","get","result","meta","status","goods","Math","ceil","total","name","reg","RegExp","r","window","search","substr","match","decodeURI"],"mappings":"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","sourcesContent":["$(function(){\r\n\r\n    let QueryObj = {\r\n        query:\"\",\r\n        cid: getUrl(\"cid\"),\r\n        pagenum:1,\r\n        pagesize:10\r\n    };\r\n\r\n    let TotalPage = 1;\r\n\r\n    init();\r\n    function init() {\r\n        \r\n        eventList();\r\n\r\n        mui.init({\r\n            pullRefresh:{\r\n                container:\".pyg_view\",\r\n                down:{\r\n                    auto:true,\r\n                    callback:function() {\r\n                        let cb = function(data) {\r\n\r\n                            let html = template(\"mainTpl\",{arr:data});\r\n                            console.log(html)\r\n                            $(\".list\").html(html);\r\n                            \r\n                            mui(\".pyg_view\")\r\n                            .pullRefresh()\r\n                            .endPulldownToRefresh();\r\n\r\n                            mui('.pyg_view').pullRefresh().refresh(true);\r\n                        };\r\n\r\n                        QueryObj.pagenum = 1;\r\n                        goodsSearch(cb);\r\n                    }\r\n                },\r\n                up:{\r\n                    callback:function() {\r\n                        if(QueryObj.pagenum >= TotalPage){\r\n\r\n                            mui(\".pyg_view\")\r\n                            .pullRefresh()\r\n                            .endPullupToRefresh(true);\r\n\r\n                        } else {\r\n                            QueryObj.pagenum++;\r\n\r\n                            let cb = function(data) {\r\n                                let html = template(\"mainTpl\",{arr:data});\r\n                                $(\".list\").append(html);\r\n\r\n                                mui(\".pyg_view\")\r\n                                .pullRefresh()\r\n                                .endPullupToRefresh(false);\r\n                            };\r\n\r\n                            goodsSearch(cb);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    function eventList() {\r\n        $(\".list\").on(\"tap\",\"a\",function() {\r\n            let href = this.href;\r\n            location.href = href;\r\n        })\r\n    }\r\n\r\n    function goodsSearch(func) {\r\n        $.get(\r\n            \"http://api.pyg.ak48.xyz/api/public/v1/goods/search\",\r\n            QueryObj,\r\n            function(result) {\r\n                if(result.meta.status == 200){\r\n\r\n                    let data = result.data.goods;\r\n\r\n                    TotalPage = Math.ceil(result.data.total / QueryObj.pagesize);\r\n                    console.log(TotalPage);\r\n\r\n                    func(data);\r\n                } else {\r\n                    console.log(\"失败\",result)\r\n                }\r\n            }\r\n        );\r\n    }\r\n\r\n    function getUrl(name) {\r\n        var reg = new RegExp(\"(^|&)\" + name + \"=([^&]*)(&|$)\", \"i\");\r\n        var r = window.location.search.substr(1).match(reg);\r\n        if (r != null) return decodeURI(r[2]);\r\n        return null;\r\n    }\r\n})"],"file":"goods_list.js"}